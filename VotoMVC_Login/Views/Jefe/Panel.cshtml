@model VotoMVC_Login.Models.JefePanelVm
@{
    ViewData["Title"] = "Panel Jefe de Junta";
    var m = Model ?? new VotoMVC_Login.Models.JefePanelVm();
}

@section Styles {
    <link rel="stylesheet" href="~/css/jefe-panel.css" asp-append-version="true" />
}

<div class="jefe-page">
    <div class="jefe-wrap">

        <!-- HERO -->
        <div class="jefe-hero mb-3">
            <div class="content">
                <div>
                    <h2 class="mb-0">Panel del Jefe de Junta</h2>
                    <p class="mb-0">Ingresa la cédula del votante para consultar sus datos, mesa y código PAD.</p>
                </div>

                <div class="jefe-badge">
                    <div class="small">Sesión iniciada</div>
                    <div class="big">@User.Identity?.Name</div>
                </div>
            </div>
        </div>

        @if (!string.IsNullOrWhiteSpace(m.Error))
        {
            <div class="alert alert-danger mb-3">@m.Error</div>
        }
        @if (!string.IsNullOrWhiteSpace(m.Msg))
        {
            <div class="alert alert-info mb-3">@m.Msg</div>
        }

        <!-- BUSCADOR -->
        <div class="jefe-card mb-3">
            <div class="card-body">
                <div class="jefe-section-title">
                    <div class="jefe-icon">🔎</div>
                    <div>
                        <h5>Buscar votante</h5>
                        <div class="sub">Consulta rápida por cédula (10 dígitos)</div>
                    </div>
                </div>

                <form asp-controller="Jefe" asp-action="Panel" method="post" class="row g-2 jefe-form">
                    @Html.AntiForgeryToken()

                    <div class="col-lg-8">
                        <input class="form-control"
                               name="cedulaBuscada"
                               maxlength="10"
                               placeholder="Cédula del votante (10 dígitos)"
                               value="@m.CedulaBuscada"
                               required />
                    </div>

                    <div class="col-lg-4 d-grid">
                        <button class="btn btn-primary" type="submit">Buscar</button>
                    </div>
                </form>
            </div>
        </div>

        @if (m.Ciudadano != null)
        {
            <!-- PERFIL (foto + nombre) -->
            <div class="jefe-card mb-3">
                <div class="card-body d-flex align-items-center gap-3">
                    <div class="avatar">
                        <img src="@(string.IsNullOrWhiteSpace(m.Ciudadano.imagenUrl) ? Url.Content("~/img/user-default.png") : m.Ciudadano.imagenUrl)"
                             alt="Foto del votante"
                             onerror="this.src='@Url.Content("~/img/user-default.png")';" />
                    </div>

                    <div>
                        <div class="fw-bold" style="font-size:1.05rem;">
                            @m.Ciudadano.nombres @m.Ciudadano.apellidos
                        </div>
                        <div class="text-muted small">
                            Cédula: @m.Ciudadano.cedula
                        </div>
                    </div>
                </div>
            </div>

            <div class="jefe-grid">
                <!-- DATOS PERSONALES -->
                <div class="jefe-card">
                    <div class="card-body">
                        <div class="jefe-section-title">
                            <div class="jefe-icon">👤</div>
                            <div>
                                <h5>Datos personales</h5>
                                <div class="sub">Información del ciudadano</div>
                            </div>
                        </div>

                        <div class="kv">
                            <div class="item" style="grid-column: 1 / -1;">
                                <div class="label">Cédula</div>
                                <div class="value">@m.Ciudadano.cedula</div>
                            </div>

                            <div class="item">
                                <div class="label">Nombres</div>
                                <div class="value">@m.Ciudadano.nombres</div>
                            </div>

                            <div class="item">
                                <div class="label">Apellidos</div>
                                <div class="value">@m.Ciudadano.apellidos</div>
                            </div>

                            <div class="item" style="grid-column: 1 / -1;">
                                <div class="label">Correo</div>
                                <div class="value">@(string.IsNullOrWhiteSpace(m.Ciudadano.correo) ? "—" : m.Ciudadano.correo)</div>
                            </div>

                            <div class="item" style="grid-column: 1 / -1;">
                                <div class="label">Teléfono</div>
                                <div class="value">@(string.IsNullOrWhiteSpace(m.Ciudadano.telefono) ? "—" : m.Ciudadano.telefono)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- UBICACIÓN / JUNTA -->
                <div class="jefe-card">
                    <div class="card-body">
                        <div class="jefe-section-title">
                            <div class="jefe-icon">📍</div>
                            <div>
                                <h5>Ubicación / Junta</h5>
                                <div class="sub">Detalles geográficos y mesa</div>
                            </div>
                        </div>

                        <div class="kv">
                            <div class="item">
                                <div class="label">Provincia</div>
                                <div class="value">@(string.IsNullOrWhiteSpace(m.Ciudadano.provincia) ? "—" : m.Ciudadano.provincia)</div>
                            </div>

                            <div class="item">
                                <div class="label">Cantón</div>
                                <div class="value">@(string.IsNullOrWhiteSpace(m.Ciudadano.canton) ? "—" : m.Ciudadano.canton)</div>
                            </div>

                            <div class="item" style="grid-column: 1 / -1;">
                                <div class="label">Mesa</div>
                                <div class="value">@(string.IsNullOrWhiteSpace(m.Ciudadano.mesa) ? "—" : m.Ciudadano.mesa)</div>
                            </div>
                        </div>

                        <div class="pad-box">
                            <div>
                                <div class="label">Código asignado (PAD)</div>
                                @if (!string.IsNullOrWhiteSpace(m.Ciudadano.codigoPad))
                                {
                                    <div class="code">@m.Ciudadano.codigoPad</div>
                                }
                                else
                                {
                                    <div class="code">—</div>
                                }
                            </div>
                            <div class="pad-pill">Padrón</div>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>
</div>
