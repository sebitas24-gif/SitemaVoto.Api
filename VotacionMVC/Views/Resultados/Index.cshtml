@model VotacionMVC.Models.DTOs.ResultadosNacionalDto
@{
    ViewData["Title"] = "Resultados";
    var tab = (string)(ViewBag.Tab ?? "envivo");
}

<div class="text-center mb-4">
    <h1 class="mb-1">📊 Resultados Electorales en Tiempo Real</h1>
    <div class="text-muted">@Model.proceso</div>

    <div class="mt-3">
        <a class="btn @(tab=="envivo" ? "btn-primary" : "btn-outline-primary")"
           asp-controller="Resultados" asp-action="Index" asp-route-tab="envivo">En vivo</a>

        <a class="btn @(tab=="finales" ? "btn-primary" : "btn-outline-primary")"
           asp-controller="Resultados" asp-action="Index" asp-route-tab="finales">Finales</a>
    </div>
</div>

<div class="card mb-4">
    <div class="card-body d-flex justify-content-between">
        <div>
            <div class="text-muted">Estado del proceso</div>
            <div class="fw-bold">@Model.estadoProceso</div>
        </div>
        <div class="text-end">
            <div class="text-muted">Última actualización</div>
            <div class="fw-bold">@Model.ultimaActualizacion</div>
        </div>
    </div>
</div>

<div class="card mb-4" style="background:#2fb065;color:white;">
    <div class="card-body text-center py-5">
        <div class="mb-2">🏆 CANDIDATO LIDERANDO</div>
        <h2 class="mb-3">@(!string.IsNullOrWhiteSpace(Model.candidatoLider) ? Model.candidatoLider : "—")</h2>
        <div class="opacity-75">Nacional</div>
        <div style="font-size:48px;font-weight:800;">@Model.votosTotales votos</div>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <h4 class="mb-3">Detalle por candidato</h4>

        @if (Model.items == null || !Model.items.Any())
        {
            <div class="alert alert-warning mb-0">
                No hay datos (o la API devolvió vacío).
            </div>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-striped align-middle">
                    <thead>
                        <tr>
                            <th>Candidato</th>
                            <th>Partido</th>
                            <th>Votos</th>
                            <th>%</th>
                        </tr>
                    </thead>
                    <tbody>
                    @foreach (var x in Model.items.OrderByDescending(x => x.votos))
                    {
                        <tr>
                            <td>@x.nombre</td>
                            <td>@x.partido</td>
                            <td>@x.votos</td>
                            <td>@x.porcentaje</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>
